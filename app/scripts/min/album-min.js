var setSong=function(e){currentSoundFile&&currentSoundFile.stop(),currentlyPlayingSongNumber=parseInt(e),currentSongFromAlbum=currentAlbum.songs[e-1],currentSoundFile=new buzz.sound(currentSongFromAlbum.audioUrl,{formats:["mp3"],preload:!0}),setVolume(currentVolume)},seek=function(e){currentSoundFile&&currentSoundFile.setTime(e)},setVolume=function(e){currentSoundFile&&currentSoundFile.setVolume(e)},getSongNumberCell=function(e){return $('.song-item-number[data-song-number="'+e+'"]')},createSongRow=function(e,t,n){var r='<tr class="album-view-song-item">  <td class="song-item-number" data-song-number="'+e+'">'+e+'</td>  <td class="song-item-title">'+t+'</td>  <td class="song-item-duration">'+n+"</td></tr>",u=$(r),l=function(){var e=$(this).find(".song-item-number"),t=e.attr("data-song-number"),n=function(){var e=$(".player-bar h2");e.eq(0).html(currentAlbum.artist+" â€“ "+currentSongFromAlbum.name),e.eq(1).html(currentSongFromAlbum.name),e.eq(2).html(currentAlbum.artist),$(".main-controls .play-pause").html(playerBarPauseButton)};if(null===currentlyPlayingSongNumber){e.html(pauseButtonTemplate),setSong(t),n();var r=$(".volume .fill"),u=$(".volume .thumb");r.width(currentVolume+"%"),u.css({left:currentVolume+"%"}),currentSoundFile.play()}else if(currentlyPlayingSongNumber===parseInt(t))currentSoundFile.isPaused()?(currentSoundFile.play(),e.html(pauseButtonTemplate),$(".main-controls .play-pause").html(playerBarPauseButton)):(currentSoundFile.pause(),e.html(playButtonTemplate),$(".main-controls .play-pause").html(playerBarPlayButton));else if(currentlyPlayingSongNumber!==parseInt(t)){e.html(pauseButtonTemplate);var l=$('[data-song-number="'+currentlyPlayingSongNumber+'"]');l.html(currentlyPlayingSongNumber),setSong(t),n(),currentSoundFile.play()}updateSeekBarWhileSongPlays()},a=function(){var e=$(this).find(".song-item-number"),t=parseInt(e.attr("data-song-number"));t!==currentlyPlayingSongNumber&&e.html(playButtonTemplate)},o=function(){var e=$(this).find(".song-item-number"),t=parseInt(e.attr("data-song-number"));t!==currentlyPlayingSongNumber&&e.html(t)};return u.click(l),u.hover(a,o),u},setCurrentAlbum=function(e){currentAlbum=e;var t=$(".album-view-title"),n=$(".album-view-artist"),r=$(".album-view-release-info"),u=$(".album-cover-art"),l=$(".album-view-song-list");t.text(e.name),n.text(e.artist),r.text(e.year),u.attr("src",e.albumArtUrl),l.empty();for(var a=0;a<e.songs.length;a++){var o=createSongRow(a+1,e.songs[a].name,e.songs[a].length);l.append(o)}},setCurrentTimeInPlayerBar=function(e){var t=$(".currently-playing .current-time");t.html(e)},setTotalTimeInPlayerBar=function(e){var t=$(".currently-playing .total-time");e=Math.floor(e);var n=Math.floor(e/60),r=e%60,u=n+":"+r;t.html(u)},updateSeekBarWhileSongPlays=function(){currentSoundFile&&currentSoundFile.bind("timeupdate",function(e){var t=this.getTime()/this.getDuration();setTotalTimeInPlayerBar(this.getDuration());var n=$(".seek-control .seek-bar"),r=buzz.toTimer(this.getTime());setCurrentTimeInPlayerBar(r.slice(1)),updateSeekPercentage(n,t)})},updateSeekPercentage=function(e,t){var n=100*t;n=Math.max(0,n),n=Math.min(100,n);var r=n+"%";e.find(".fill").width(r),e.find(".thumb").css({left:r})},setupSeekBars=function(){var e=$(".player-bar .seek-bar");e.click(function(e){var t=e.pageX-$(this).offset().left,n=$(this).width(),r=t/n;"seek-control"==$(this).parent().attr("class")?seek(r*currentSoundFile.getDuration()):setVolume(100*r),updateSeekPercentage($(this),r)}),e.find(".thumb").mousedown(function(e){var t=$(this).parent();$(document).bind("mousemove.thumb",function(e){var n=e.pageX-t.offset().left,r=t.width(),u=n/r;"seek-control"==t.parent().attr("class")?seek(u*currentSoundFile.getDuration()):setVolume(u),updateSeekPercentage(t,u)}),$(document).bind("mouseup.thumb",function(){$(document).unbind("mousemove.thumb"),$(document).unbind("mouseup.thumb")})})},trackIndex=function(e,t){return e.songs.indexOf(t)},nextSong=function(){if(null!==currentSongFromAlbum){var e=function(e){return 0===e?currentAlbum.songs.length:e},t=trackIndex(currentAlbum,currentSongFromAlbum);if(t++,t>=currentAlbum.songs.length&&(t=0),currentSoundFile.isPaused()){setSong(t+1),$(".currently-playing .song-name").text(currentSongFromAlbum.name),$(".currently-playing .artist-name").text(currentAlbum.artist),$(".currently-playing .artist-song-mobile").text(currentAlbum.artist+" - "+currentSongFromAlbum.name);var n=e(t),r=getSongNumberCell(currentlyPlayingSongNumber),u=getSongNumberCell(n);u.html(n),r.html(playButtonTemplate),$(".main-controls .play-pause").html(playerBarPlayButton),updateSeekBarWhileSongPlays()}else{setSong(t+1),$(".currently-playing .song-name").text(currentSongFromAlbum.name),$(".currently-playing .artist-name").text(currentAlbum.artist),$(".currently-playing .artist-song-mobile").text(currentAlbum.artist+" - "+currentSongFromAlbum.name);var n=e(t),r=getSongNumberCell(currentlyPlayingSongNumber),u=getSongNumberCell(n);u.html(n),r.html(pauseButtonTemplate),$(".main-controls .play-pause").html(playerBarPauseButton),currentSoundFile.play(),updateSeekBarWhileSongPlays()}}},previousSong=function(){if(null!==currentlyPlayingSongNumber){var e=function(e){return e===currentAlbum.songs.length-1?1:e+2},t=trackIndex(currentAlbum,currentSongFromAlbum);if(t--,0>t&&(t=currentAlbum.songs.length-1),currentSoundFile.isPaused()){setSong(t+1),$(".currently-playing .song-name").text(currentSongFromAlbum.name),$(".currently-playing .artist-name").text(currentAlbum.artist),$(".currently-playing .artist-song-mobile").text(currentAlbum.artist+" - "+currentSongFromAlbum.name),$(".main-controls .play-pause").html(playerBarPlayButton);var n=e(t),r=getSongNumberCell(currentlyPlayingSongNumber),u=getSongNumberCell(n);r.html(playButtonTemplate),u.html(n),updateSeekBarWhileSongPlays()}else{setSong(t+1),$(".currently-playing .song-name").text(currentSongFromAlbum.name),$(".currently-playing .artist-name").text(currentAlbum.artist),$(".currently-playing .artist-song-mobile").text(currentAlbum.artist+" - "+currentSongFromAlbum.name),$(".main-controls .play-pause").html(playerBarPauseButton);var n=e(t),r=getSongNumberCell(currentlyPlayingSongNumber),u=getSongNumberCell(n);r.html(pauseButtonTemplate),u.html(n),currentSoundFile.play(),updateSeekBarWhileSongPlays()}}},togglePlayFromPlayerBar=function(){currentSoundFile.isPaused()?(currentSoundFile.play(),$playPause.html(playerBarPauseButton),getSongNumberCell(currentlyPlayingSongNumber).html(pauseButtonTemplate)):(currentSoundFile.pause(),$playPause.html(playerBarPlayButton),getSongNumberCell(currentlyPlayingSongNumber).html(playButtonTemplate))},playButtonTemplate='<a class="album-song-button"><span class="ion-play"></span></a>',pauseButtonTemplate='<a class="album-song-button"><span class="ion-pause"></span></a>',playerBarPlayButton='<span class="ion-play"><span>',playerBarPauseButton='<span class="ion-pause"><span>',currentAlbum=null,currentlyPlayingSongNumber=null,currentSongFromAlbum=null,currentSoundFile=null,currentVolume=80,$previousButton=$(".main-controls .previous"),$nextButton=$(".main-controls .next"),$playPause=$(".main-controls .play-pause");$(document).ready(function(){setCurrentAlbum(albumPicasso),$previousButton.click(previousSong),$nextButton.click(nextSong),$playPause.click(togglePlayFromPlayerBar),setupSeekBars()});